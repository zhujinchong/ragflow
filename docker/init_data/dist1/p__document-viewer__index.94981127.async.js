(self.webpackChunk=self.webpackChunk||[]).push([[948],{2039:function(G,h,e){"use strict";e.d(h,{I3:function(){return d},pG:function(){return J},qM:function(){return V}});var M=e(15009),j=e.n(M),B=e(99289),H=e.n(B),K=e(5574),b=e.n(K),U=e(21640),Z=e(3321),W=e(18446),$=e.n(W),v=e(62435),I=e(67421),T=e(86074),J=function(){var E=(0,v.useState)(!1),l=b()(E,2),n=l[0],o=l[1],x=function(){o(!0)},S=function(){o(!1)},C=function(){o(!n)};return{visible:n,showModal:x,hideModal:S,switchVisible:C}},Y=function(E,l){var n=useRef(),o=function(){};isEqual(l,n.current)||(o=E(),n.current=l),useEffect(function(){return function(){o&&o()}},[])};function re(D){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=useRef(),n=useState(!1),o=_slicedToArray(n,2),x=o[0],S=o[1],C=useState(),p=_slicedToArray(C,2),N=p[0],F=p[1],y=E.onCompleted,R=E.onError;return useEffect(function(){S(!0);var O=function(){var z=_asyncToGenerator(_regeneratorRuntime().mark(function c(){return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e(86635)(D);case 3:l.current=r.sent.ReactComponent,y==null||y(D,l.current),r.next=11;break;case 7:r.prev=7,r.t0=r.catch(0),R==null||R(r.t0),F(r.t0);case 11:return r.prev=11,S(!1),r.finish(11);case 14:case"end":return r.stop()}},c,null,[[0,7,11,14]])}));return function(){return z.apply(this,arguments)}}();O()},[D,y,R]),{error:N,loading:x,SvgIcon:l.current}}var d=function(){var E=Z.Z.useApp(),l=E.modal,n=(0,I.$G)(),o=n.t,x=(0,v.useCallback)(function(S){var C=S.onOk,p=S.onCancel;return new Promise(function(N,F){l.confirm({title:o("common.deleteModalTitle"),icon:(0,T.jsx)(U.Z,{}),okText:o("common.ok"),okType:"danger",cancelText:o("common.cancel"),onOk:function(){return H()(j()().mark(function R(){var O;return j()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,C==null?void 0:C();case 3:O=c.sent,N(O),console.info(O),c.next=11;break;case 8:c.prev=8,c.t0=c.catch(0),F(c.t0);case 11:case"end":return c.stop()}},R,null,[[0,8]])}))()},onCancel:function(){p==null||p()}})})},[o,l]);return x},V=function(E){return(0,I.$G)("translation",{keyPrefix:E})},q=function(){return useTranslation("translation",{keyPrefix:"common"})}},4772:function(G,h,e){"use strict";e.d(h,{Z:function(){return Z}});var M=e(86250),j=e(38925),B=e(2039),H=e(62435),K={errorWrapper:"errorWrapper___QfVXQ"},b=e(86074),U=function($){var v=$.children,I=(0,B.qM)("fileManager"),T=I.t;return(0,b.jsx)(M.Z,{align:"center",justify:"center",className:K.errorWrapper,children:(0,b.jsx)(j.Z,{type:"error",message:(0,b.jsx)("h2",{children:v||T("fileError")})})})},Z=U},11785:function(G,h,e){"use strict";e.r(h),e.d(h,{default:function(){return c}});var M=e(5574),j=e.n(M),B=e(40169),H=e(60806),K=e(86250),b=e(98163),U=e(6589),Z=e(75081),W=e(4772),$=e(15009),v=e.n($),I=e(99289),T=e.n(I),J=e(40903),Y=e(5121),re=e(59255),d=e(62435),V=function(r){var i=(0,d.useState)(""),a=j()(i,2),f=a[0],s=a[1],u=(0,d.useCallback)(T()(v()().mark(function t(){var m,g;return v()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,Y.Z.get(r);case 2:return m=_.sent,g=m.data,!(g instanceof ArrayBuffer)&&g.retcode!==0&&s(g.retmsg),_.abrupt("return",m);case 6:case"end":return _.stop()}},t)})),[r]);return(0,d.useEffect)(function(){u()},[u]),{fetchDocument:u,error:f}},q=function(){var r=(0,d.useCallback)(function(){var i=T()(v()().mark(function a(f){var s;return v()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y.Z.get(f,{responseType:"arraybuffer"});case 2:return s=t.sent,t.abrupt("return",s);case 4:case"end":return t.stop()}},a)}));return function(a){return i.apply(this,arguments)}}(),[]);return{fetchDocument:r}},D=function(r){var i=(0,d.useState)(!0),a=j()(i,2),f=a[0],s=a[1],u=q(),t=u.fetchDocument,m=(0,d.useRef)(null),g=V(r),Q=g.error,_=(0,d.useCallback)(T()(v()().mark(function ee(){var L,X,A;return v()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return m.current&&(X=J.Z.init(m.current)),P.next=3,t(r);case 3:A=P.sent,(L=X)===null||L===void 0||L.preview(A.data).then(function(){console.log("succeed"),s(!0)}).catch(function(k){console.warn("failed",k),X.destroy(),s(!1)});case 5:case"end":return P.stop()}},ee)})),[r,t]);return(0,d.useEffect)(function(){_()},[_]),{status:f,containerRef:m,error:Q}},E=function(r){var i=(0,d.useState)(!0),a=j()(i,2),f=a[0],s=a[1],u=q(),t=u.fetchDocument,m=(0,d.useRef)(null),g=V(r),Q=g.error,_=(0,d.useCallback)(T()(v()().mark(function ee(){var L;return v()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,t(r);case 2:L=A.sent,re.convertToHtml({arrayBuffer:L.data},{includeDefaultStyleMap:!0}).then(function(ne){s(!0);var P=document.createElement("div");P.className="document-container",P.innerHTML=ne.value;var k=m.current;k&&(k.innerHTML=P.outerHTML)}).catch(function(){s(!1)});case 4:case"end":return A.stop()}},ee)})),[r,t]);return(0,d.useEffect)(function(){_()},[_]),{succeed:f,containerRef:m,error:Q}},l={docxViewerWrapper:"docxViewerWrapper___bSxaq",box:"box___sXFPE"},n=e(86074),o=function(r){var i=r.filePath,a=E(i),f=a.succeed,s=a.containerRef,u=a.error;return(0,n.jsx)(n.Fragment,{children:f?(0,n.jsx)("section",{className:l.docxViewerWrapper,children:(0,n.jsx)("div",{id:"docx",ref:s,className:l.box,children:(0,n.jsx)(Z.Z,{})})}):(0,n.jsx)(W.Z,{children:u})})},x=o,S=e(21992),C=function(r){var i=r.filePath,a=D(i),f=a.status,s=a.containerRef,u=a.error;return(0,n.jsx)("div",{id:"excel",ref:s,style:{height:"100%",width:"100%"},children:f||(0,n.jsx)(W.Z,{children:u})})},p=C,N=e(21687),F=e(49723),y=function(r){var i=r.url,a=V(i),f=a.error,s=function(){};return(0,n.jsx)("div",{style:{width:"100%",height:"100%"},children:(0,n.jsx)(F.Hz,{url:i,beforeLoad:(0,n.jsx)(N.Z,{active:!0}),workerSrc:"/pdfjs-dist/pdf.worker.min.js",errorMessage:(0,n.jsx)(W.Z,{children:f}),onError:function(t){console.warn(t)},children:function(t){return(0,n.jsx)(F.Nb,{pdfDocument:t,enableAreaSelection:function(g){return g.altKey},onScrollChange:s,scrollRef:function(){},onSelectionFinished:function(){return null},highlightTransform:function(){return(0,n.jsx)("div",{})},highlights:[]})}})})},R=y,O={viewerWrapper:"viewerWrapper___Hh0uK",image:"image___OwcS1"},z=function(){var r=(0,U.useParams)(),i=r.id,a="".concat(H.N,"/file/get/").concat(i),f=(0,U.useSearchParams)(),s=j()(f,1),u=s[0],t=u.get("ext");return(0,n.jsxs)("section",{className:O.viewerWrapper,children:[B.rU.includes(t)&&(0,n.jsx)(K.Z,{className:O.image,align:"center",justify:"center",children:(0,n.jsx)(b.Z,{src:a,preview:!1})}),t==="pdf"&&(0,n.jsx)(R,{url:a}),(t==="xlsx"||t==="xls")&&(0,n.jsx)(p,{filePath:a}),t==="docx"&&(0,n.jsx)(x,{filePath:a})]})},c=z},86635:function(G){function h(e){return Promise.resolve().then(function(){var M=new Error("Cannot find module '"+e+"'");throw M.code="MODULE_NOT_FOUND",M})}h.keys=function(){return[]},h.resolve=h,h.id=86635,G.exports=h},64838:function(){},27922:function(){},15212:function(){},85777:function(){},76929:function(){},45036:function(){}}]);

//# sourceMappingURL=p__document-viewer__index.94981127.async.js.map