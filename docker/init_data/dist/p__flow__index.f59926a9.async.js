(self.webpackChunk=self.webpackChunk||[]).push([[4845],{2039:function($,E,e){"use strict";e.d(E,{I3:function(){return J},pG:function(){return n},qM:function(){return q}});var H=e(15009),j=e.n(H),G=e(99289),o=e.n(G),i=e(5574),z=e.n(i),L=e(21640),Y=e(3321),X=e(18446),ce=e.n(X),F=e(62435),W=e(67421),Q=e(86074),n=function(){var _=(0,F.useState)(!1),g=z()(_,2),y=g[0],v=g[1],N=function(){v(!0)},P=function(){v(!1)},R=function(){v(!y)};return{visible:y,showModal:N,hideModal:P,switchVisible:R}},oe=function(_,g){var y=useRef(),v=function(){};isEqual(g,y.current)||(v=_(),y.current=g),useEffect(function(){return function(){v&&v()}},[])};function se(x){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},g=useRef(),y=useState(!1),v=_slicedToArray(y,2),N=v[0],P=v[1],R=useState(),w=_slicedToArray(R,2),K=w[0],k=w[1],T=_.onCompleted,U=_.onError;return useEffect(function(){P(!0);var I=function(){var ee=_asyncToGenerator(_regeneratorRuntime().mark(function h(){return _regeneratorRuntime().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.prev=0,p.next=3,e(86635)(x);case 3:g.current=p.sent.ReactComponent,T==null||T(x,g.current),p.next=11;break;case 7:p.prev=7,p.t0=p.catch(0),U==null||U(p.t0),k(p.t0);case 11:return p.prev=11,P(!1),p.finish(11);case 14:case"end":return p.stop()}},h,null,[[0,7,11,14]])}));return function(){return ee.apply(this,arguments)}}();I()},[x,T,U]),{error:K,loading:N,SvgIcon:g.current}}var J=function(){var _=Y.Z.useApp(),g=_.modal,y=(0,W.$G)(),v=y.t,N=(0,F.useCallback)(function(P){var R=P.onOk,w=P.onCancel;return new Promise(function(K,k){g.confirm({title:v("common.deleteModalTitle"),icon:(0,Q.jsx)(L.Z,{}),okText:v("common.ok"),okType:"danger",cancelText:v("common.cancel"),onOk:function(){return o()(j()().mark(function U(){var I;return j()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.prev=0,h.next=3,R==null?void 0:R();case 3:I=h.sent,K(I),console.info(I),h.next=11;break;case 8:h.prev=8,h.t0=h.catch(0),k(h.t0);case 11:case"end":return h.stop()}},U,null,[[0,8]])}))()},onCancel:function(){w==null||w()}})})},[v,g]);return N},q=function(_){return(0,W.$G)("translation",{keyPrefix:_})},ie=function(){return useTranslation("translation",{keyPrefix:"common"})}},48215:function($,E,e){"use strict";e.r(E),e.d(E,{default:function(){return Pe}});var H=e(5574),j=e.n(H),G=e(21612),o=e(62435),i=e(37261),z=e(97857),L=e.n(z),Y=e(40009),X=e(34334),ce=e(94326),F=e(13769),W=e.n(F),Q={contextMenu:"contextMenu___cNBsU"},n=e(86074),oe=["id","top","left","right","bottom"];function se(s){var t=s.id,r=s.top,a=s.left,l=s.right,u=s.bottom,d=W()(s,oe),f=(0,i._K)(),c=f.getNode,C=f.setNodes,D=f.addNodes,b=f.setEdges,A=(0,o.useCallback)(function(){var O,M,m=c(t),V={x:(m==null||(O=m.position)===null||O===void 0?void 0:O.x)||0+50,y:(m==null||(M=m.position)===null||M===void 0?void 0:M.y)||0+50};D(L()(L()({},m||{}),{},{data:m==null?void 0:m.data,selected:!1,dragging:!1,id:"".concat(m==null?void 0:m.id,"-copy"),position:V}))},[t,c,D]),S=(0,o.useCallback)(function(){C(function(O){return O.filter(function(M){return M.id!==t})}),b(function(O){return O.filter(function(M){return M.source!==t})})},[t,C,b]);return(0,n.jsxs)("div",L()(L()({style:{top:r,left:a,right:l,bottom:u},className:Q.contextMenu},d),{},{children:[(0,n.jsx)("p",{style:{margin:"0.5em"},children:(0,n.jsxs)("small",{children:["node: ",t]})}),(0,n.jsx)("button",{onClick:A,type:"button",children:"duplicate"}),(0,n.jsx)("button",{onClick:S,type:"button",children:"delete"})]}))}var J=function(t){var r=(0,o.useState)({}),a=j()(r,2),l=a[0],u=a[1],d=(0,o.useRef)(null),f=(0,o.useCallback)(function(C,D){var b;C.preventDefault();var A=(b=d.current)===null||b===void 0?void 0:b.getBoundingClientRect();u({id:D.id,top:C.clientY-72,left:C.clientX-t})},[t]),c=(0,o.useCallback)(function(){return u({})},[u]);return{onNodeContextMenu:f,menu:l,onPaneClick:c,ref:d}},q=e(85265),ie=function(t){var r=t.visible,a=t.hideModal;return(0,n.jsx)(q.Z,{title:"Basic Drawer",placement:"right",onClose:a,open:r,getContainer:!1,mask:!1,children:(0,n.jsx)("p",{children:"Some contents..."})})},x=ie,_=e(2039),g=e(57632),y=function(){var t=(0,o.useCallback)(function(r){return function(a){a.dataTransfer.setData("application/reactflow",r),a.dataTransfer.effectAllowed="move"}},[]);return{handleDragStart:t}},v=function(t){var r=(0,o.useState)(),a=j()(r,2),l=a[0],u=a[1],d=(0,o.useCallback)(function(c){c.preventDefault(),c.dataTransfer.dropEffect="move"},[]),f=(0,o.useCallback)(function(c){c.preventDefault();var C=c.dataTransfer.getData("application/reactflow");if(!(typeof C=="undefined"||!C)){var D=l==null?void 0:l.screenToFlowPosition({x:c.clientX,y:c.clientY}),b={id:(0,g.Z)(),type:"textUpdater",position:D||{x:0,y:0},data:{label:"".concat(C)},sourcePosition:i.Ly.Right,targetPosition:i.Ly.Left};t(function(A){return A.concat(b)})}},[l,t]);return{onDrop:f,onDragOver:d,setReactFlowInstance:u}},N=function(){var t=(0,_.pG)(),r=t.visible,a=t.hideModal,l=t.showModal;return{drawerVisible:r,hideDrawer:a,showDrawer:l}},P=function(){var t=(0,o.useState)([]),r=j()(t,2),a=r[0],l=r[1],u=(0,o.useState)([]),d=j()(u,2),f=d[0],c=d[1];return(0,i.AQ)({onChange:function(D){var b=D.nodes,A=D.edges;l(b.map(function(S){return S.id})),c(A.map(function(S){return S.id}))}}),{selectedEdges:f,selectedNodes:a}},R=function(t){var r=(0,i._K)(),a=r.setEdges,l=(0,o.useCallback)(function(){a(function(u){return u.filter(function(d){return t.every(function(f){return f!==d.id})})})},[a,t]);return l},w=function(t,r){var a=R(t),l=(0,o.useCallback)(function(u){u.code==="Delete"&&a()},[a]);return{handleKeyUp:l}},K=function(){var t=(0,o.useCallback)(function(){},[]);return{saveGraph:t}},k=e(27496),T=e(67841),U=e(82099),I=[{name:"Begin",icon:(0,n.jsx)(k.Z,{}),description:""},{name:"Retrieval",icon:(0,n.jsx)(T.Z,{}),description:""},{name:"Generate",icon:(0,n.jsx)(U.Z,{}),description:""}],ee=[{sourcePosition:i.Ly.Left,targetPosition:i.Ly.Right,id:"node-1",type:"textUpdater",position:{x:0,y:0},data:{label:123}},{sourcePosition:i.Ly.Right,targetPosition:i.Ly.Left,id:"1",data:{label:"Hello"},position:{x:0,y:0},type:"input"},{sourcePosition:i.Ly.Right,targetPosition:i.Ly.Left,id:"2",data:{label:"World"},position:{x:0,y:0}}],h=[{id:"1-2",source:"1",target:"2",label:"to the",type:"step"}],ne={graph:{nodes:[{id:"begin",type:"textUpdater",position:{x:50,y:200},data:{label:"Begin"},sourcePosition:"left",targetPosition:"right"},{id:"Answer:China",type:"textUpdater",position:{x:150,y:200},data:{label:"Answer"},sourcePosition:"left",targetPosition:"right"},{id:"Retrieval:China",type:"textUpdater",position:{x:250,y:200},data:{label:"Retrieval"},sourcePosition:"left",targetPosition:"right"},{id:"Generate:China",type:"textUpdater",position:{x:100,y:100},data:{label:"Generate"},sourcePosition:"left",targetPosition:"right"}],edges:[{id:"7facb53d-65c9-43b3-ac55-339c445d3891",label:"",source:"begin",target:"Answer:China",markerEnd:{type:"arrow"}},{id:"7ac83631-502d-410f-a6e7-bec6866a5e99",label:"",source:"Generate:China",target:"Answer:China",markerEnd:{type:"arrow"}},{id:"0aaab297-5779-43ed-9281-2c4d3741566f",label:"",source:"Answer:China",target:"Retrieval:China",markerEnd:{type:"arrow"}},{id:"3477f9f3-0a7d-400e-af96-a11ea7673183",label:"",source:"Retrieval:China",target:"Generate:China",markerEnd:{type:"arrow"}}]},components:{begin:{obj:{component_name:"Begin",params:{}},downstream:["Answer:China"],upstream:[]},"Answer:China":{obj:{component_name:"Answer",params:{}},downstream:["Retrieval:China"],upstream:["begin","Generate:China"]},"Retrieval:China":{obj:{component_name:"Retrieval",params:{}},downstream:["Generate:China"],upstream:["Answer:China"]},"Generate:China":{obj:{component_name:"Generate",params:{}},downstream:["Answer:China"],upstream:["Retrieval:China"]}},history:[],path:["begin"],answer:[]},p={textUpdaterNode:"textUpdaterNode___dtx75"};function ve(s){var t=s.data,r=s.isConnectable,a=r===void 0?!0:r;return(0,n.jsxs)("div",{className:p.textUpdaterNode,children:[(0,n.jsx)(i.HH,{type:"target",position:i.Ly.Left,isConnectable:a}),(0,n.jsx)(i.HH,{type:"source",position:i.Ly.Right,isConnectable:a}),(0,n.jsx)("div",{children:t.label})]})}var fe={textUpdater:ve};function pe(s){var t=s.sideWidth,r=(0,o.useState)(ne.graph.nodes),a=j()(r,2),l=a[0],u=a[1],d=(0,o.useState)(ne.graph.edges),f=j()(d,2),c=f[0],C=f[1],D=P(),b=D.selectedEdges,A=D.selectedNodes,S=J(t),O=S.ref,M=S.menu,m=S.onNodeContextMenu,V=S.onPaneClick,ae=N(),Re=ae.drawerVisible,Oe=ae.hideDrawer,ue=ae.showDrawer,Ne=(0,o.useCallback)(function(Z){return u(function(B){return(0,i.Fb)(Z,B)})},[]),Te=(0,o.useCallback)(function(Z){return C(function(B){return(0,i.yn)(Z,B)})},[]),Ue=(0,o.useCallback)(function(Z){return C(function(B){return(0,i.Z_)(Z,B)})},[]),Ae=(0,o.useCallback)(function(){ue()},[ue]),re=v(u),Le=re.onDrop,Ie=re.onDragOver,He=re.setReactFlowInstance,Ge=w(b,A),Ke=Ge.handleKeyUp;return(0,o.useEffect)(function(){console.info("nodes:",l),console.info("edges:",c)},[l,c]),(0,n.jsxs)("div",{style:{height:"100%",width:"100%"},children:[(0,n.jsxs)(i.x$,{ref:O,nodes:l,onNodesChange:Ne,onNodeContextMenu:m,edges:c,onEdgesChange:Te,fitView:!0,onConnect:Ue,nodeTypes:fe,onPaneClick:V,onDrop:Le,onDragOver:Ie,onNodeClick:Ae,onInit:He,onKeyUp:Ke,children:[(0,n.jsx)(Y.A,{}),(0,n.jsx)(X.Z,{}),Object.keys(M).length>0&&(0,n.jsx)(se,L()({onClick:V},M))]}),(0,n.jsx)(x,{visible:Re,hideModal:Oe})]})}var he=pe,te=e(86250),me=e(4393),ge=e(42075),Ce=e(7134),_e=e(93967),De=e.n(_e),le={operatorCard:"operatorCard___tL0Y2",cubeIcon:"cubeIcon___yMe3G",siderContent:"siderContent___FpKZk"},be=G.Z.Sider,ye=function(t){var r=t.setCollapsed,a=t.collapsed,l=y(),u=l.handleDragStart;return(0,n.jsx)(be,{collapsible:!0,collapsed:a,collapsedWidth:0,theme:"light",onCollapse:function(f){return r(f)},children:(0,n.jsx)(te.Z,{vertical:!0,gap:10,className:le.siderContent,children:I.map(function(d){return(0,n.jsx)(me.Z,{hoverable:!0,draggable:!0,className:De()(le.operatorCard),onDragStart:u(d.name),children:(0,n.jsx)(te.Z,{justify:"space-between",align:"center",children:(0,n.jsxs)(ge.Z,{size:15,children:[(0,n.jsx)(Ce.C,{icon:d.icon,shape:"square"}),(0,n.jsxs)("section",{children:[(0,n.jsx)("b",{children:d.name}),(0,n.jsx)("div",{children:d.description})]})]})})},d.name)})})})},we=ye,de=e(15867),Ee={flowHeader:"flowHeader___e7L06"},je=function(){var t=K(),r=t.saveGraph;return(0,n.jsxs)(te.Z,{align:"center",justify:"end",gap:"large",className:Ee.flowHeader,children:[(0,n.jsx)(de.ZP,{children:(0,n.jsx)("b",{children:"Debug"})}),(0,n.jsx)(de.ZP,{type:"primary",onClick:r,children:(0,n.jsx)("b",{children:"Save"})})]})},xe=je,Se=G.Z.Content;function Me(){var s=(0,o.useState)(!1),t=j()(s,2),r=t[0],a=t[1];return(0,n.jsx)(G.Z,{children:(0,n.jsxs)(i.tV,{children:[(0,n.jsx)(we,{setCollapsed:a,collapsed:r}),(0,n.jsxs)(G.Z,{children:[(0,n.jsx)(xe,{}),(0,n.jsx)(Se,{style:{margin:"0 16px"},children:(0,n.jsx)(he,{sideWidth:r?0:200})})]})]})})}var Pe=Me},86635:function($){function E(e){return Promise.resolve().then(function(){var H=new Error("Cannot find module '"+e+"'");throw H.code="MODULE_NOT_FOUND",H})}E.keys=function(){return[]},E.resolve=E,E.id=86635,$.exports=E}}]);

//# sourceMappingURL=p__flow__index.f59926a9.async.js.map