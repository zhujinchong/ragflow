(self.webpackChunk=self.webpackChunk||[]).push([[948],{2039:function(G,h,e){"use strict";e.d(h,{I3:function(){return d},pG:function(){return J},qM:function(){return V}});var M=e(15009),j=e.n(M),B=e(99289),H=e.n(B),K=e(5574),b=e.n(K),U=e(21640),Z=e(3321),W=e(18446),$=e.n(W),v=e(62435),I=e(67421),T=e(86074),J=function(){var _=(0,v.useState)(!1),i=b()(_,2),n=i[0],o=i[1],x=function(){o(!0)},S=function(){o(!1)},C=function(){o(!n)};return{visible:n,showModal:x,hideModal:S,switchVisible:C}},Y=function(_,i){var n=useRef(),o=function(){};isEqual(i,n.current)||(o=_(),n.current=i),useEffect(function(){return function(){o&&o()}},[])};function re(D){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=useRef(),n=useState(!1),o=_slicedToArray(n,2),x=o[0],S=o[1],C=useState(),p=_slicedToArray(C,2),N=p[0],F=p[1],y=_.onCompleted,w=_.onError;return useEffect(function(){S(!0);var R=function(){var z=_asyncToGenerator(_regeneratorRuntime().mark(function c(){return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e(86635)(D);case 3:i.current=r.sent.ReactComponent,y==null||y(D,i.current),r.next=11;break;case 7:r.prev=7,r.t0=r.catch(0),w==null||w(r.t0),F(r.t0);case 11:return r.prev=11,S(!1),r.finish(11);case 14:case"end":return r.stop()}},c,null,[[0,7,11,14]])}));return function(){return z.apply(this,arguments)}}();R()},[D,y,w]),{error:N,loading:x,SvgIcon:i.current}}var d=function(){var _=Z.Z.useApp(),i=_.modal,n=(0,I.$G)(),o=n.t,x=(0,v.useCallback)(function(S){var C=S.onOk,p=S.onCancel;return new Promise(function(N,F){i.confirm({title:o("common.deleteModalTitle"),icon:(0,T.jsx)(U.Z,{}),okText:o("common.ok"),okType:"danger",cancelText:o("common.cancel"),onOk:function(){return H()(j()().mark(function w(){var R;return j()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,C==null?void 0:C();case 3:R=c.sent,N(R),console.info(R),c.next=11;break;case 8:c.prev=8,c.t0=c.catch(0),F(c.t0);case 11:case"end":return c.stop()}},w,null,[[0,8]])}))()},onCancel:function(){p==null||p()}})})},[o,i]);return x},V=function(_){return(0,I.$G)("translation",{keyPrefix:_})},q=function(){return useTranslation("translation",{keyPrefix:"common"})}},4772:function(G,h,e){"use strict";e.d(h,{Z:function(){return Z}});var M=e(86250),j=e(38925),B=e(2039),H=e(62435),K={errorWrapper:"errorWrapper___QfVXQ"},b=e(86074),U=function($){var v=$.children,I=(0,B.qM)("fileManager"),T=I.t;return(0,b.jsx)(M.Z,{align:"center",justify:"center",className:K.errorWrapper,children:(0,b.jsx)(j.Z,{type:"error",message:(0,b.jsx)("h2",{children:v||T("fileError")})})})},Z=U},11785:function(G,h,e){"use strict";e.r(h),e.d(h,{default:function(){return c}});var M=e(5574),j=e.n(M),B=e(40169),H=e(60806),K=e(86250),b=e(98163),U=e(6589),Z=e(75081),W=e(4772),$=e(15009),v=e.n($),I=e(99289),T=e.n(I),J=e(40903),Y=e(5121),re=e(59255),d=e(62435),V=function(r){var l=(0,d.useState)(""),t=j()(l,2),f=t[0],s=t[1],u=(0,d.useCallback)(T()(v()().mark(function a(){var m,g;return v()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,Y.Z.get(r);case 2:return m=E.sent,g=m.data,!(g instanceof ArrayBuffer)&&g.retcode!==0&&s(g.retmsg),E.abrupt("return",m);case 6:case"end":return E.stop()}},a)})),[r]);return(0,d.useEffect)(function(){u()},[u]),{fetchDocument:u,error:f}},q=function(){var r=(0,d.useCallback)(function(){var l=T()(v()().mark(function t(f){var s;return v()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Y.Z.get(f,{responseType:"arraybuffer"});case 2:return s=a.sent,a.abrupt("return",s);case 4:case"end":return a.stop()}},t)}));return function(t){return l.apply(this,arguments)}}(),[]);return{fetchDocument:r}},D=function(r){var l=(0,d.useState)(!0),t=j()(l,2),f=t[0],s=t[1],u=q(),a=u.fetchDocument,m=(0,d.useRef)(null),g=V(r),Q=g.error,E=(0,d.useCallback)(T()(v()().mark(function ee(){var L,X,A;return v()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return m.current&&(X=J.Z.init(m.current)),P.next=3,a(r);case 3:A=P.sent,(L=X)===null||L===void 0||L.preview(A.data).then(function(){console.log("succeed"),s(!0)}).catch(function(k){console.warn("failed",k),X.destroy(),s(!1)});case 5:case"end":return P.stop()}},ee)})),[r,a]);return(0,d.useEffect)(function(){E()},[E]),{status:f,containerRef:m,error:Q}},_=function(r){var l=(0,d.useState)(!0),t=j()(l,2),f=t[0],s=t[1],u=q(),a=u.fetchDocument,m=(0,d.useRef)(null),g=V(r),Q=g.error,E=(0,d.useCallback)(T()(v()().mark(function ee(){var L;return v()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,a(r);case 2:L=A.sent,re.convertToHtml({arrayBuffer:L.data},{includeDefaultStyleMap:!0}).then(function(ne){s(!0);var P=document.createElement("div");P.className="document-container",P.innerHTML=ne.value;var k=m.current;k&&(k.innerHTML=P.outerHTML)}).catch(function(){s(!1)});case 4:case"end":return A.stop()}},ee)})),[r,a]);return(0,d.useEffect)(function(){E()},[E]),{succeed:f,containerRef:m,error:Q}},i={docxViewerWrapper:"docxViewerWrapper___bSxaq",box:"box___sXFPE"},n=e(86074),o=function(r){var l=r.filePath,t=_(l),f=t.succeed,s=t.containerRef,u=t.error;return(0,n.jsx)(n.Fragment,{children:f?(0,n.jsx)("section",{className:i.docxViewerWrapper,children:(0,n.jsx)("div",{id:"docx",ref:s,className:i.box,children:(0,n.jsx)(Z.Z,{})})}):(0,n.jsx)(W.Z,{children:u})})},x=o,S=e(21992),C=function(r){var l=r.filePath,t=D(l),f=t.status,s=t.containerRef,u=t.error;return(0,n.jsx)("div",{id:"excel",ref:s,style:{height:"100%",width:"100%"},children:f||(0,n.jsx)(W.Z,{children:u})})},p=C,N=e(21687),F=e(49723),y=function(r){var l=r.url,t=V(l),f=t.error,s=function(){};return(0,n.jsx)("div",{style:{width:"100%",height:"100%"},children:(0,n.jsx)(F.Hz,{url:l,beforeLoad:(0,n.jsx)(N.Z,{active:!0}),workerSrc:"/pdfjs-dist/pdf.worker.min.js",errorMessage:(0,n.jsx)(W.Z,{children:f}),onError:function(a){console.warn(a)},children:function(a){return(0,n.jsx)(F.Nb,{pdfDocument:a,enableAreaSelection:function(g){return g.altKey},onScrollChange:s,scrollRef:function(){},onSelectionFinished:function(){return null},highlightTransform:function(){return(0,n.jsx)("div",{})},highlights:[]})}})})},w=y,R={viewerWrapper:"viewerWrapper___Hh0uK",image:"image___OwcS1"},z=function(){var r=(0,U.useParams)(),l=r.id,t="".concat(H.N,"/file/get/").concat(l),f=(0,U.useSearchParams)(),s=j()(f,1),u=s[0],a=u.get("ext");return(0,n.jsxs)("section",{className:R.viewerWrapper,children:[B.rU.includes(a)&&(0,n.jsx)(K.Z,{className:R.image,align:"center",justify:"center",children:(0,n.jsx)(b.Z,{src:t,preview:!1})}),a==="pdf"&&(0,n.jsx)(w,{url:t}),(a==="xlsx"||a==="xls")&&(0,n.jsx)(p,{filePath:t}),a==="docx"&&(0,n.jsx)(x,{filePath:t})]})},c=z},86635:function(G){function h(e){return Promise.resolve().then(function(){var M=new Error("Cannot find module '"+e+"'");throw M.code="MODULE_NOT_FOUND",M})}h.keys=function(){return[]},h.resolve=h,h.id=86635,G.exports=h},64838:function(){},27922:function(){},15212:function(){},85777:function(){},76929:function(){},45036:function(){}}]);

//# sourceMappingURL=p__document-viewer__index.379b0895.async.js.map